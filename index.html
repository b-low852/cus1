<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Will You Be My Valentine? üíï</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&family=Great+Vibes&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ffb6c1 0%, #ffc0cb 30%, #ffb6d9 60%, #ffc0e1 100%);
            background-size: 400% 400%;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            animation: gradientMove 15s ease infinite;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 768px) {
            body {
                overflow-x: hidden;
            }
        }

        @keyframes gradientMove {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        /* Animated background images */
        .bg-image {
            position: fixed;
            width: 150px;
            height: 150px;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0.3;
            pointer-events: none;
            z-index: 1;
        }

        @media (max-width: 768px) {
            .bg-image {
                width: 100px;
                height: 100px;
            }
        }

        @media (max-width: 480px) {
            .bg-image {
                width: 80px;
                height: 80px;
            }
        }

        @keyframes moveImage {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg) scale(1);
            }
            25% {
                transform: translate(100px, -100px) rotate(90deg) scale(1.2);
            }
            50% {
                transform: translate(-80px, 80px) rotate(180deg) scale(0.8);
            }
            75% {
                transform: translate(120px, 100px) rotate(270deg) scale(1.1);
            }
        }

        @keyframes moveImageReverse {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg) scale(1);
            }
            25% {
                transform: translate(-100px, 100px) rotate(-90deg) scale(1.2);
            }
            50% {
                transform: translate(80px, -80px) rotate(-180deg) scale(0.8);
            }
            75% {
                transform: translate(-120px, -100px) rotate(-270deg) scale(1.1);
            }
        }

        /* Sparkle/shine effects - varied floating */
        .sparkle-bg {
            position: fixed;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            z-index: 2;
            box-shadow: 0 0 6px 2px rgba(255, 255, 255, 0.8),
                        0 0 12px 4px rgba(255, 255, 255, 0.6);
        }

        .sparkle-bg.sparkle-twinkle {
            animation: sparkleTwinkle 2s ease-in-out infinite;
        }

        .sparkle-bg.sparkle-drift {
            animation: sparkleDrift 4s ease-in-out infinite;
        }

        .sparkle-bg.sparkle-float {
            animation: sparkleFloat 5s ease-in-out infinite;
        }

        .sparkle-bg.sparkle-pulse {
            animation: sparklePulse 2.5s ease-in-out infinite;
        }

        .sparkle-bg.sparkle-heart {
            display: inline-block;
            width: auto;
            height: auto;
            font-size: 12px;
            background: none;
            box-shadow: none;
            opacity: 0.7;
            animation: sparkleHeartFloat 6s ease-in-out infinite;
        }

        @keyframes sparkleTwinkle {
            0%, 100% { opacity: 0; transform: scale(0) rotate(0deg); }
            50% { opacity: 1; transform: scale(1) rotate(180deg); }
        }

        @keyframes sparkleDrift {
            0%, 100% { opacity: 0.3; transform: translate(0, 0); }
            25% { opacity: 1; transform: translate(15px, -20px); }
            75% { opacity: 0.8; transform: translate(-10px, 15px); }
        }

        @keyframes sparkleFloat {
            0%, 100% { opacity: 0.4; transform: translateY(0) scale(1); }
            50% { opacity: 1; transform: translateY(-25px) scale(1.3); }
        }

        @keyframes sparklePulse {
            0%, 100% { opacity: 0.5; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.4); }
        }

        @keyframes sparkleHeartFloat {
            0%, 100% { opacity: 0.4; transform: translateY(0) rotate(-10deg); }
            50% { opacity: 0.9; transform: translateY(-30px) rotate(10deg); }
        }

        /* Shimmer effect overlay */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent
            );
            animation: shimmer 3s ease-in-out infinite;
            pointer-events: none;
            z-index: 3;
        }

        @keyframes shimmer {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        .container {
            text-align: center;
            padding: 60px 40px;
            max-width: 800px;
            width: 90%;
            position: relative;
            z-index: 10;
            animation: fadeIn 1s ease-in;
        }

        @media (max-width: 768px) {
            .container {
                padding: 40px 20px;
                width: 95%;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .title-gif {
            max-width: 200px;
            height: auto;
            margin-bottom: 20px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            animation: fadeIn 1s ease-in, titleGifFloat 3s ease-in-out infinite;
        }

        @keyframes titleGifFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        @media (max-width: 768px) {
            .title-gif {
                max-width: 150px;
                margin-bottom: 15px;
            }
        }

        h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5em;
            font-weight: 600;
            color: #e91e63;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            display: inline-block;
            letter-spacing: 2px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5em;
                letter-spacing: 1px;
                margin-bottom: 15px;
            }
        }

        .chain-text {
            display: inline-block;
        }

        .chain-text span {
            display: inline-block;
            opacity: 0;
            animation: chainReveal 0.1s forwards;
        }

        @keyframes chainReveal {
            from {
                opacity: 0;
                transform: translateY(20px) rotateX(90deg);
            }
            to {
                opacity: 1;
                transform: translateY(0) rotateX(0deg);
            }
        }

        .question {
            font-size: 1.5em;
            color: white;
            margin-bottom: 40px;
            font-weight: 300;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        @media (max-width: 768px) {
            .question {
                font-size: 1.3em;
                margin-bottom: 30px;
            }
        }

        .button-container {
            display: flex;
            gap: 30px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 40px;
        }

        @media (max-width: 768px) {
            .button-container {
                gap: 20px;
                margin-top: 30px;
            }
        }

        @media (max-width: 480px) {
            .button-container {
                flex-direction: column;
                gap: 15px;
                width: 100%;
            }
        }

        .btn {
            padding: 20px 50px;
            font-size: 1.3em;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            min-width: 120px;
            touch-action: manipulation;
        }

        @media (max-width: 768px) {
            .btn {
                padding: 18px 40px;
                font-size: 1.2em;
                min-width: 110px;
            }
        }

        @media (max-width: 480px) {
            .btn {
                padding: 16px 35px;
                font-size: 1.1em;
                width: 100%;
                max-width: 280px;
                min-width: auto;
            }
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-yes {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform-origin: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .btn-yes:hover {
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-yes.growing {
            animation: growButton 0.5s ease forwards;
        }

        @keyframes growButton {
            from {
                transform: scale(1);
            }
            to {
                transform: scale(var(--scale, 1.2));
            }
        }

        .btn-no {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            position: relative;
            transition: all 0.2s ease;
        }

        .btn-no:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(245, 87, 108, 0.4);
        }

        .btn-no:active {
            transform: translateY(0);
        }

        .celebration {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            min-width: 100vw;
            min-height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s ease;
            overflow: hidden;
            padding: 40px 20px;
            box-sizing: border-box;
            margin: 0;
            -ms-overflow-style: none;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 768px) {
            .celebration {
                padding: 30px 15px;
            }
        }

        @media (max-width: 480px) {
            .celebration {
                padding: 20px 10px;
            }
        }

        .celebration::-webkit-scrollbar {
            display: none;
            width: 0;
            height: 0;
        }

        .celebration::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                45deg,
                rgba(255, 182, 193, 0.1) 0%,
                rgba(255, 192, 203, 0.1) 25%,
                rgba(255, 255, 255, 0.15) 50%,
                rgba(255, 192, 203, 0.1) 75%,
                rgba(255, 182, 193, 0.1) 100%
            );
            background-size: 400% 400%;
            animation: rainbowShimmer 8s ease infinite;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes rainbowShimmer {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        .celebration.show {
            display: flex !important;
        }

        /* Card view - shows card.gif first after Yes */
        .celebration-card-view {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            cursor: pointer;
            width: 100%;
            min-height: 100%;
            box-sizing: border-box;
        }

        .celebration-card-view.hidden {
            display: none !important;
        }

        .celebration-letter-view {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            min-height: 100%;
        }

        .celebration-letter-view.show {
            display: flex !important;
        }

        .celebration-card-gif {
            max-width: 90%;
            max-height: 70vh;
            width: auto;
            height: auto;
            object-fit: contain;
            animation: bounceIn 1s ease;
        }

        .card-view-hint {
            margin-top: 20px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        body.celebration-active,
        body.game-active {
            overflow: hidden !important;
        }

        /* Hide scrollbars */
        .celebration::-webkit-scrollbar,
        .game-container::-webkit-scrollbar,
        body::-webkit-scrollbar {
            display: none;
            width: 0;
            height: 0;
        }

        .celebration,
        .game-container,
        body {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        body.celebration-active .container,
        body.game-active .container {
            display: none;
        }

        .celebration-content {
            text-align: center;
            color: white;
            animation: bounceIn 1s ease;
            max-width: 900px;
            max-height: calc(100vh - 80px);
            padding: 40px;
            position: relative;
            z-index: 1002;
            overflow-y: auto;
            overflow-x: hidden;
            box-sizing: border-box;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        @media (max-width: 768px) {
            .celebration-content {
                padding: 30px 20px;
                max-height: calc(100vh - 60px);
            }
        }

        @media (max-width: 480px) {
            .celebration-content {
                padding: 20px 15px;
                max-height: calc(100vh - 40px);
            }
        }

        .celebration-content::-webkit-scrollbar {
            display: none;
            width: 0;
            height: 0;
        }

        @keyframes bounceIn {
            0% {
                transform: scale(0);
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                transform: scale(1);
            }
        }

        .celebration-gif {
            max-width: 200px;
            height: auto;
            margin: 20px;
            display: inline-block;
            animation: fadeIn 1s ease-in, floatGif 3s ease-in-out infinite;
            position: relative;
        }

        @media (max-width: 768px) {
            .celebration-gif {
                max-width: 150px;
                margin: 15px;
            }
        }

        @media (max-width: 480px) {
            .celebration-gif {
                max-width: 120px;
                margin: 10px;
            }
        }

        @keyframes floatGif {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-10px) rotate(2deg);
            }
        }

        .celebration-content h2 {
            font-size: 4em;
            font-weight: 600;
            margin-bottom: 30px;
            color: #ffffff;
            text-shadow: 3px 3px 15px rgba(0, 0, 0, 0.8), 0 0 20px rgba(255, 255, 255, 0.6);
            letter-spacing: 2px;
            line-height: 1.2;
            animation: pulseGlow 2s ease-in-out infinite, shimmerText 3s ease-in-out infinite;
            position: relative;
        }

        @media (max-width: 768px) {
            .celebration-content h2 {
                font-size: 3em;
                margin-bottom: 20px;
                letter-spacing: 1px;
            }
        }

        @media (max-width: 480px) {
            .celebration-content h2 {
                font-size: 2.2em;
                margin-bottom: 15px;
            }
        }

        @keyframes pulseGlow {
            0%, 100% {
                transform: scale(1);
                text-shadow: 3px 3px 15px rgba(0, 0, 0, 0.8), 0 0 20px rgba(255, 255, 255, 0.6), 0 0 30px rgba(255, 255, 255, 0.4);
            }
            50% {
                transform: scale(1.05);
                text-shadow: 3px 3px 15px rgba(0, 0, 0, 0.8), 0 0 30px rgba(255, 255, 255, 0.8), 0 0 50px rgba(255, 255, 255, 0.6), 0 0 70px rgba(255, 255, 255, 0.4);
            }
        }

        @keyframes shimmerText {
            0% {
                background-position: -200% center;
            }
            100% {
                background-position: 200% center;
            }
        }

        .celebration-content h2::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        .celebration-content p {
            font-size: 1.8em;
            font-weight: 400;
            margin-top: 25px;
            margin-bottom: 15px;
            letter-spacing: 1px;
            line-height: 1.6;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.8), 0 0 15px rgba(255, 255, 255, 0.5);
            max-width: 90%;
            margin-left: auto;
            margin-right: auto;
            opacity: 0;
            animation: fadeInUp 0.8s ease forwards, textGlow 3s ease-in-out infinite;
            position: relative;
        }

        @media (max-width: 768px) {
            .celebration-content p {
                font-size: 1.4em;
                margin-top: 20px;
                margin-bottom: 12px;
                line-height: 1.5;
            }
        }

        @media (max-width: 480px) {
            .celebration-content p {
                font-size: 1.1em;
                margin-top: 15px;
                margin-bottom: 10px;
                line-height: 1.4;
                max-width: 95%;
            }
        }

        .celebration-content p:nth-child(3) {
            animation-delay: 0.3s;
        }

        .celebration-content p:nth-child(4) {
            animation-delay: 0.6s;
        }

        .celebration-content p:nth-child(5) {
            animation-delay: 0.9s;
        }

        /* Letter 2-section slides */
        .letter-slides-wrap {
            width: 100%;
            max-width: 720px;
            margin: 0 auto;
            position: relative;
            min-height: 200px;
        }

        .letter-slide {
            display: none;
            padding: 16px 10px;
            animation: fadeInUp 0.5s ease;
        }

        .letter-slide.show {
            display: block;
        }

        .letter-slide p {
            font-size: 1.35em;
            line-height: 1.7;
            margin: 0 0 1em;
            text-align: justify;
        }

        .letter-slide .letter-greeting {
            font-family: 'Dancing Script', cursive;
            font-size: 1.5em;
            margin-bottom: 1.2em;
            text-align: left;
        }

        .letter-slide .letter-signature {
            margin-top: 1.5em;
            text-align: right;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .letter-slide p { font-size: 1.15em; }
            .letter-slide .letter-greeting { font-size: 1.35em; }
        }

        @media (max-width: 480px) {
            .letter-slide p { font-size: 1em; }
            .letter-slide .letter-greeting { font-size: 1.2em; }
        }

        /* Section 2 pics row (pic1, pic4) */
        .letter-slide-pics {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 1.2em;
            flex-wrap: wrap;
        }

        /* GIF in center, pics left and right */
        .celebration-gif-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 10px 0 16px;
            flex-wrap: wrap;
        }

        .celebration-gif-row .celebration-gif {
            margin: 0;
        }

        .celebration-pic {
            max-width: 130px;
            width: 22vw;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.3);
            animation: celebrationPicFloat 4s ease-in-out infinite;
            cursor: pointer;
        }

        .celebration-pic.pic-left {
            transform: rotate(-8deg);
            animation-delay: 0s;
            animation-name: celebrationPicFloatLeft;
        }

        .celebration-pic.pic-right {
            transform: rotate(8deg);
            animation-delay: 1.2s;
            animation-name: celebrationPicFloatRight;
        }

        @keyframes celebrationPicFloatLeft {
            0%, 100% { transform: translateY(0) rotate(-8deg); }
            50% { transform: translateY(-12px) rotate(-5deg); }
        }

        @keyframes celebrationPicFloatRight {
            0%, 100% { transform: translateY(0) rotate(8deg); }
            50% { transform: translateY(-12px) rotate(11deg); }
        }

        @media (max-width: 768px) {
            .celebration-gif-row { gap: 12px; margin: 8px 0 12px; }
            .celebration-pic { max-width: 90px; }
        }

        .letter-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding: 0 10px;
            gap: 12px;
        }

        .letter-nav-btn {
            padding: 10px 20px;
            font-size: 0.95em;
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.5);
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .letter-nav-btn:hover:not(:disabled) {
            background: rgba(255,255,255,0.35);
            transform: scale(1.05);
        }

        .letter-nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .letter-dots {
            display: flex;
            gap: 8px;
        }

        .letter-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255,255,255,0.4);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .letter-dot.active {
            background: white;
            transform: scale(1.2);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes textGlow {
            0%, 100% {
                text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.8), 0 0 15px rgba(255, 255, 255, 0.5);
            }
            50% {
                text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.8), 0 0 25px rgba(255, 255, 255, 0.7), 0 0 35px rgba(255, 255, 255, 0.5);
            }
        }

        .sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ffffff;
            border-radius: 50%;
            animation: sparkle 1s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% {
                opacity: 0;
                transform: scale(0);
            }
            50% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-10px);
            }
            75% {
                transform: translateX(10px);
            }
        }

        /* Sound Control Button */
        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            transition: all 0.3s ease;
            font-size: 24px;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .sound-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .sound-toggle.muted {
            opacity: 0.6;
        }

        .sound-toggle.muted::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 30px;
            background: white;
            transform: rotate(45deg);
        }

        @media (max-width: 600px) {
            .sound-toggle {
                width: 45px;
                height: 45px;
                top: 15px;
                right: 15px;
                font-size: 20px;
            }
        }

        /* Card Matching Game */
        .game-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            min-width: 100vw;
            min-height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1001;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
            margin: 0;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 768px) {
            .game-container {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .game-container {
                padding: 10px;
            }
        }

        .game-container.show {
            display: flex;
        }

        .game-header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .game-header {
                margin-bottom: 20px;
            }
        }

        @media (max-width: 480px) {
            .game-header {
                margin-bottom: 15px;
            }
        }

        .game-header h2 {
            font-size: 3em;
            margin-bottom: 10px;
            color: #ffffff;
        }

        .game-stats {
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(4, 120px);
            gap: 15px;
            justify-content: center;
            max-width: 600px;
        }

        @media (max-width: 768px) {
            .card-grid {
                grid-template-columns: repeat(4, 100px);
                gap: 12px;
                max-width: 100%;
            }
        }

        .card {
            width: 120px;
            height: 120px;
            perspective: 1000px;
            cursor: pointer;
            touch-action: manipulation;
        }

        @media (max-width: 768px) {
            .card {
                width: 100px;
                height: 100px;
            }
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card.matched .card-inner {
            transform: rotateY(180deg);
            opacity: 0.7;
        }

        .card-front,
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3em;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 768px) {
            .card-front,
            .card-back {
                font-size: 2.5em;
                border-radius: 12px;
            }
        }

        .card-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .card-back {
            background: linear-gradient(135deg, #ffb6c1 0%, #ffc0cb 100%);
            color: #e91e63;
            transform: rotateY(180deg);
        }

        .game-complete {
            display: none;
            text-align: center;
            color: white;
            animation: bounceIn 1s ease;
            position: relative;
            z-index: 1003;
        }

        .game-complete.show {
            display: block;
        }


        .celebration-video {
            max-width: 600px;
            width: 90%;
            height: auto;
            border-radius: 20px;
            margin: 20px auto;
            display: block;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5), 0 0 60px rgba(255, 255, 255, 0.4);
            animation: fadeIn 1s ease-in, videoGlow 3s ease-in-out infinite;
        }

        @media (max-width: 768px) {
            .celebration-video {
                width: 95%;
                margin: 15px auto;
                border-radius: 15px;
            }
        }

        @media (max-width: 480px) {
            .celebration-video {
                width: 98%;
                margin: 10px auto;
                border-radius: 10px;
            }
        }

        @keyframes videoGlow {
            0%, 100% {
                box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5), 0 0 60px rgba(255, 255, 255, 0.4);
            }
            50% {
                box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6), 0 0 80px rgba(255, 255, 255, 0.6), 0 0 100px rgba(255, 255, 255, 0.4);
            }
        }

        .restart-btn {
            margin-top: 20px;
            padding: 15px 40px;
            font-size: 1.2em;
            background: linear-gradient(135deg, #ffb6c1 0%, #ffc0cb 50%, #ffb6d9 100%);
            color: #8b4562;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            animation: buttonPulse 2s ease-in-out infinite, buttonShine 3s ease-in-out infinite;
            box-shadow: 0 5px 20px rgba(255, 182, 193, 0.5), 0 0 30px rgba(255, 192, 203, 0.3);
            touch-action: manipulation;
        }

        @media (max-width: 768px) {
            .restart-btn {
                padding: 14px 35px;
                font-size: 1.1em;
                margin-top: 15px;
            }
        }

        @media (max-width: 480px) {
            .restart-btn {
                padding: 12px 30px;
                font-size: 1em;
                margin-top: 12px;
                width: 90%;
                max-width: 250px;
            }
        }

        @keyframes buttonPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 5px 20px rgba(255, 182, 193, 0.5), 0 0 30px rgba(255, 192, 203, 0.3);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 8px 30px rgba(255, 182, 193, 0.6), 0 0 50px rgba(255, 192, 203, 0.4);
            }
        }

        @keyframes buttonShine {
            0% {
                background-position: -200% center;
            }
            100% {
                background-position: 200% center;
            }
        }

        .restart-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: buttonShimmer 3s infinite;
        }

        @keyframes buttonShimmer {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        .restart-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 35px rgba(255, 182, 193, 0.6), 0 0 60px rgba(255, 192, 203, 0.4);
        }

        /* Celebration sparkles */
        .celebration-sparkle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ffffff;
            border-radius: 50%;
            pointer-events: none;
            z-index: 1001;
            box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.9), 0 0 20px 4px rgba(255, 255, 255, 0.5);
            animation: celebrationSparkle 2s ease-in-out infinite;
        }

        @keyframes celebrationSparkle {
            0%, 100% {
                opacity: 0;
                transform: scale(0) rotate(0deg);
            }
            50% {
                opacity: 1;
                transform: scale(1) rotate(180deg);
            }
        }

        /* Rotating sparkles around GIF */
        .celebration-gif::before,
        .celebration-gif::after {
            content: '‚ú®';
            position: absolute;
            font-size: 2em;
            animation: rotateAround 4s linear infinite;
            pointer-events: none;
        }

        .celebration-gif::before {
            top: -30px;
            left: 50%;
            transform-origin: 0 80px;
        }

        .celebration-gif::after {
            bottom: -30px;
            right: 50%;
            transform-origin: 0 -80px;
            animation-duration: 4s;
            animation-direction: reverse;
        }

        @keyframes rotateAround {
            from {
                transform: rotate(0deg) translateX(80px) rotate(0deg);
            }
            to {
                transform: rotate(360deg) translateX(80px) rotate(-360deg);
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.8em;
            }
            
            .question {
                font-size: 1.1em;
            }
            
            .card-grid {
                grid-template-columns: repeat(4, 70px);
                gap: 8px;
            }
            
            .card {
                width: 70px;
                height: 70px;
            }
            
            .card-front,
            .card-back {
                font-size: 2em;
                border-radius: 10px;
            }
            
            .game-header h2 {
                font-size: 1.8em;
            }
            
            .game-stats {
                font-size: 1em;
            }

            .game-container {
                padding: 15px;
            }
        }

        @media (max-width: 360px) {
            h1 {
                font-size: 1.5em;
            }

            .title-gif {
                max-width: 100px;
            }

            .card-grid {
                grid-template-columns: repeat(4, 60px);
                gap: 6px;
            }
            
            .card {
                width: 60px;
                height: 60px;
            }
            
            .card-front,
            .card-back {
                font-size: 1.5em;
            }

            .game-header h2 {
                font-size: 1.5em;
            }
        }

        /* Image lightbox - click photo to view */
        .image-lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .image-lightbox.show {
            display: flex;
        }
        .image-lightbox-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            cursor: pointer;
        }
        .image-lightbox img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            position: relative;
            z-index: 2001;
        }
        .image-lightbox-close {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 44px;
            height: 44px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            z-index: 2002;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }
    </style>
</head>
<body>
    <!-- Background Music -->
    <audio id="backgroundMusic" loop autoplay>
        <source src="folded.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Sound Toggle Button -->
    <button class="sound-toggle" id="soundToggle" title="Toggle Sound">
        üîä
    </button>

    <!-- Background images container -->
    <div id="bg-images-container"></div>
    
    <!-- Sparkles container -->
    <div id="sparkles-container"></div>

    <div class="container">
        <img src="v3.gif" alt="Valentine GIF" class="title-gif">
        <h1 class="chain-text" id="chainTitle"></h1>
        <p class="question">I have a question for you...</p>
        
        <div class="button-container">
            <button class="btn btn-yes" id="yesBtn">Yes!</button>
            <button class="btn btn-no" id="noBtn">No</button>
        </div>
    </div>

    <div class="game-container" id="gameContainer">
        <div class="game-header">
            <h2>Memory Game</h2>
            <div class="game-stats">
                <span>Moves: <span id="moveCount">0</span></span> | 
                <span>Matches: <span id="matchCount">0</span>/8</span>
            </div>
        </div>
        <div class="card-grid" id="cardGrid"></div>
        <div class="game-complete" id="gameComplete">
            <video id="catVideo" class="celebration-video" autoplay muted loop playsinline>
                <source src="cat.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <h2>Congrat!</h2>
            <p>You complete the game!</p>
            <button class="restart-btn" onclick="restartGame()">Play Again</button>
        </div>
    </div>

    <div class="celebration" id="celebration">
        <div class="celebration-card-view" id="celebrationCardView">
            <img src="card.gif" alt="Valentine Card" class="celebration-card-gif">
            <p class="card-view-hint">Click anywhere to read your letter üíï</p>
        </div>
        <div class="celebration-letter-view" id="celebrationLetterView">
            <div class="celebration-content">
                <div class="letter-slides-wrap">
                    <div class="letter-slide show" data-slide="0">
                        <div class="celebration-gif-row">
                            <img src="pic2.jpeg" alt="" class="celebration-pic pic-left">
                            <img src="v2.gif" alt="Celebration GIF" class="celebration-gif">
                            <img src="pic3.jpeg" alt="" class="celebration-pic pic-right">
                        </div>
                        <p class="letter-greeting">To my love,<br>andrada.</p>
                        <p>Hey hunny, its your love kie, remember when we met the night before the new year? I actually ate 12 grapes under the table as my friend told me and wished that i would find someone special who would love me truly and accept myself for who i am despite my flaws.</p>
                        <p>And who knows you appeared in my life. All the memories that we created together from sweet talking, to playing games, calling each other, it was meaningful to me.</p>
                        <p>The way you comforted me when im overwhelmed with my insecurities, my family problems, it was special to me. To be honest, without you in my life, I dont know how bad these past few months would be to me.</p>
                    </div>
                    <div class="letter-slide" data-slide="1">
                        <div class="celebration-gif-row">
                            <img src="pic1.jpeg" alt="" class="celebration-pic pic-left">
                            <img src="v2.gif" alt="Celebration GIF" class="celebration-gif">
                            <img src="pic3.jpeg" alt="" class="celebration-pic pic-right">
                        </div>
                        <p>Andra, i dont want our loves and feelings towards us to be ephemeral or just a "love phase". I want us to be together forever, going through all the obstacles that will come between us. I do not want to lose you, you are the girl that i've been yearning for, the girl that i want to create a sweet future with. I WANT to be with you forever by your side.</p>
                        <p>Even though we live miles away, you are still in my heart, and i wish, I wish one day im able to hold your hands and embrace your hug in my chest. Its crazy, how a few months back you were just a stranger to me, and now you are one of the most important person in my life.</p>
                        <p>Andra, from the deepest part of my heart, i've fallen in love with you. You are the love of my life, my wife, my partner, my everything and because of that id die for you my love.</p>
                        <p>So andra, would you... be my valentine?</p>
                        <p class="letter-signature">Your love,<br>Kieran.</p>
                    </div>
                    <div class="letter-nav">
                        <button type="button" class="letter-nav-btn" id="letterPrevBtn" aria-label="Previous">‚Üê Previous</button>
                        <div class="letter-dots" id="letterDots"></div>
                        <button type="button" class="letter-nav-btn" id="letterNextBtn" aria-label="Next">Next ‚Üí</button>
                    </div>
                </div>
                <button class="restart-btn" onclick="startGame()" style="margin-top: 30px;">Play Memory Game</button>
            </div>
        </div>
    </div>

    <!-- Image lightbox: click a photo to view full size -->
    <div class="image-lightbox" id="imageLightbox">
        <div class="image-lightbox-backdrop" id="imageLightboxBackdrop"></div>
        <button type="button" class="image-lightbox-close" id="imageLightboxClose" aria-label="Close">√ó</button>
        <img src="" alt="View" id="imageLightboxImg">
    </div>

    <script>
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const celebration = document.getElementById('celebration');
        const backgroundMusic = document.getElementById('backgroundMusic');
        const soundToggle = document.getElementById('soundToggle');
        let scale = 1;
        let noClickCount = 0;
        let isMusicPlaying = false;

        // Set default volume (50%)
        backgroundMusic.volume = 0.5;

        // Sound Toggle Functionality
        function toggleSound() {
            if (isMusicPlaying) {
                backgroundMusic.pause();
                soundToggle.textContent = 'üîá';
                soundToggle.classList.add('muted');
                isMusicPlaying = false;
            } else {
                backgroundMusic.play().then(() => {
                    soundToggle.textContent = 'üîä';
                    soundToggle.classList.remove('muted');
                    isMusicPlaying = true;
                }).catch(e => {
                    console.log('Audio play failed:', e);
                    // If autoplay is blocked, show muted state
                    soundToggle.textContent = 'üîá';
                    soundToggle.classList.add('muted');
                });
            }
        }

        // Function to start music (only called on page load)
        function startMusic() {
            // Ensure audio is loaded
            if (backgroundMusic.readyState >= 2) {
                // Audio is loaded, try to play
                backgroundMusic.play().then(() => {
                    soundToggle.textContent = 'üîä';
                    soundToggle.classList.remove('muted');
                    isMusicPlaying = true;
                }).catch(e => {
                    // Autoplay was blocked
                    soundToggle.textContent = 'üîá';
                    soundToggle.classList.add('muted');
                    isMusicPlaying = false;
                });
            } else {
                // Wait for audio to load
                backgroundMusic.addEventListener('canplaythrough', function() {
                    backgroundMusic.play().then(() => {
                        soundToggle.textContent = 'üîä';
                        soundToggle.classList.remove('muted');
                        isMusicPlaying = true;
                    }).catch(e => {
                        soundToggle.textContent = 'üîá';
                        soundToggle.classList.add('muted');
                        isMusicPlaying = false;
                    });
                }, { once: true });
            }
        }

        // Try to start music immediately
        startMusic();

        // Also try when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                if (!isMusicPlaying) {
                    startMusic();
                }
            });
        }

        // Also try on window load
        window.addEventListener('load', function() {
            if (!isMusicPlaying) {
                startMusic();
            }
        });

        // Initialize sound toggle button (only toggles, doesn't auto-play)
        soundToggle.addEventListener('click', toggleSound);

        // Different reasons for clicking No
        const noReasons = [
            'No',
            'Maybe later?',
            'I need to think...',
            'Are you sure?',
            'Hmm, not sure...',
            'Really?',
            'Think again!',
            'Are you positive?',
            'One more time?',
            'Last chance!',
            'Please?',
            'Pretty please?',
            'You sure?',
            'Think about it!'
        ];

        // Create sparkles for shining background - varied and more interesting
        const sparkleTypes = ['sparkle-twinkle', 'sparkle-drift', 'sparkle-float', 'sparkle-pulse'];
        function createSparkle() {
            const container = document.getElementById('sparkles-container');
            if (!container) return;
            const isHeart = Math.random() < 0.15;
            const sparkle = document.createElement(isHeart ? 'span' : 'div');
            sparkle.className = 'sparkle-bg ' + (isHeart ? 'sparkle-heart' : sparkleTypes[Math.floor(Math.random() * sparkleTypes.length)]);
            sparkle.style.left = Math.random() * 100 + '%';
            sparkle.style.top = Math.random() * 100 + '%';
            sparkle.style.animationDelay = Math.random() * 3 + 's';
            sparkle.style.animationDuration = (2 + Math.random() * 4) + 's';
            if (isHeart) {
                sparkle.textContent = ['‚ô•', '‚úø', '‚ú¶'][Math.floor(Math.random() * 3)];
                sparkle.style.color = Math.random() < 0.5 ? '#ffb6c1' : '#fff';
                sparkle.style.fontSize = (10 + Math.random() * 10) + 'px';
            } else {
                const size = 2 + Math.random() * 5;
                sparkle.style.width = size + 'px';
                sparkle.style.height = size + 'px';
            }
            container.appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 5000);
        }

        setInterval(createSparkle, 180);
        for (let i = 0; i < 40; i++) {
            setTimeout(() => createSparkle(), i * 80);
        }

        // Chain text animation for title
        function createChainText() {
            const titleText = "Will You Be My Valentine?";
            const titleElement = document.getElementById('chainTitle');
            const letters = titleText.split('');
            
            letters.forEach((letter, index) => {
                const span = document.createElement('span');
                span.textContent = letter === ' ' ? '\u00A0' : letter;
                span.style.animationDelay = `${index * 0.05}s`;
                titleElement.appendChild(span);
            });
        }

        // Initialize chain text on page load
        createChainText();

        // Create multiple moving background images
        function createBackgroundImages() {
            const container = document.getElementById('bg-images-container');
            const images = ['8.png', '9.png'];
            const numImages = 20; // Number of images to create
            
            for (let i = 0; i < numImages; i++) {
                const img = document.createElement('div');
                img.className = 'bg-image';
                
                // Randomly choose between 8.png and 9.png
                const imageSrc = images[Math.floor(Math.random() * images.length)];
                img.style.backgroundImage = `url('${imageSrc}')`;
                
                // Random starting position
                img.style.left = Math.random() * 100 + '%';
                img.style.top = Math.random() * 100 + '%';
                
                // Random animation duration (15-30 seconds)
                const duration = 15 + Math.random() * 15;
                img.style.animation = `moveImage ${duration}s ease-in-out infinite`;
                
                // Random animation delay
                img.style.animationDelay = Math.random() * 5 + 's';
                
                // Alternate between normal and reverse animation
                if (i % 2 === 0) {
                    img.style.animationName = 'moveImage';
                } else {
                    img.style.animationName = 'moveImageReverse';
                }
                
                // Random size variation
                const size = 100 + Math.random() * 100; // 100px to 200px
                img.style.width = size + 'px';
                img.style.height = size + 'px';
                
                container.appendChild(img);
            }
        }

        // Initialize background images on page load
        createBackgroundImages();

        // Card Matching Game
        const cardSymbols = ['üíï', 'üíñ', 'üíó', 'üíì', 'üíù', 'üíò', 'üåπ', 'üíê'];
        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let moveCount = 0;
        let canFlip = true;

        function initializeGame() {
            const gameContainer = document.getElementById('gameContainer');
            const cardGrid = document.getElementById('cardGrid');
            cardGrid.innerHTML = '';
            
            // Create pairs of cards
            cards = [...cardSymbols, ...cardSymbols];
            // Shuffle cards
            cards = cards.sort(() => Math.random() - 0.5);
            
            matchedPairs = 0;
            moveCount = 0;
            flippedCards = [];
            canFlip = true;
            
            updateStats();
            
            // Create card elements
            cards.forEach((symbol, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.index = index;
                card.dataset.symbol = symbol;
                
                card.innerHTML = `
                    <div class="card-inner">
                        <div class="card-front">?</div>
                        <div class="card-back">${symbol}</div>
                    </div>
                `;
                
                card.addEventListener('click', () => flipCard(card));
                cardGrid.appendChild(card);
            });
        }

        function flipCard(card) {
            if (!canFlip || card.classList.contains('flipped') || card.classList.contains('matched')) {
                return;
            }
            
            card.classList.add('flipped');
            flippedCards.push(card);
            
            if (flippedCards.length === 2) {
                canFlip = false;
                moveCount++;
                updateStats();
                
                const [card1, card2] = flippedCards;
                
                if (card1.dataset.symbol === card2.dataset.symbol) {
                    // Match found
                    setTimeout(() => {
                        card1.classList.add('matched');
                        card2.classList.add('matched');
                        matchedPairs++;
                        flippedCards = [];
                        canFlip = true;
                        updateStats();
                        
                        if (matchedPairs === cardSymbols.length) {
                            // Game complete
                            setTimeout(() => {
                                const gameComplete = document.getElementById('gameComplete');
                                const catVideo = document.getElementById('catVideo');
                                const cardGrid = document.getElementById('cardGrid');
                                const gameHeader = document.querySelector('.game-header');
                                
                                // Hide game elements
                                if (cardGrid) cardGrid.style.display = 'none';
                                if (gameHeader) gameHeader.style.display = 'none';
                                
                                // Show completion screen with video
                                gameComplete.classList.add('show');
                                
                                // Play the video
                                if (catVideo) {
                                    catVideo.currentTime = 0;
                                    catVideo.play().catch(e => {
                                        console.log('Video autoplay prevented:', e);
                                    });
                                }
                            }, 500);
                        }
                    }, 500);
                } else {
                    // No match
                    setTimeout(() => {
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        flippedCards = [];
                        canFlip = true;
                    }, 1000);
                }
            }
        }

        function updateStats() {
            document.getElementById('moveCount').textContent = moveCount;
            document.getElementById('matchCount').textContent = matchedPairs;
        }

        function restartGame() {
            const gameComplete = document.getElementById('gameComplete');
            const catVideo = document.getElementById('catVideo');
            const cardGrid = document.getElementById('cardGrid');
            const gameHeader = document.querySelector('.game-header');
            
            gameComplete.classList.remove('show');
            
            // Show game elements again
            if (cardGrid) cardGrid.style.display = 'grid';
            if (gameHeader) gameHeader.style.display = 'block';
            
            // Reset and pause video
            if (catVideo) {
                catVideo.pause();
                catVideo.currentTime = 0;
            }
            
            initializeGame();
        }

        function startGame() {
            document.body.classList.remove('celebration-active');
            celebration.classList.remove('show');
            celebrationCardView.classList.remove('hidden');
            celebrationLetterView.classList.remove('show');
            document.body.classList.add('game-active');
            document.getElementById('gameContainer').classList.add('show');
            initializeGame();
        }

        const celebrationCardView = document.getElementById('celebrationCardView');
        const celebrationLetterView = document.getElementById('celebrationLetterView');

        /* Letter 2-section slides */
        const letterSlides = document.querySelectorAll('.letter-slide');
        const letterPrevBtn = document.getElementById('letterPrevBtn');
        const letterNextBtn = document.getElementById('letterNextBtn');
        const letterDotsEl = document.getElementById('letterDots');
        const totalLetterSlides = 2;

        function buildLetterDots() {
            if (!letterDotsEl) return;
            letterDotsEl.innerHTML = '';
            for (let i = 0; i < totalLetterSlides; i++) {
                const dot = document.createElement('span');
                dot.className = 'letter-dot' + (i === 0 ? ' active' : '');
                dot.setAttribute('aria-label', 'Section ' + (i + 1));
                dot.addEventListener('click', function() { goToLetterSlide(i); });
                letterDotsEl.appendChild(dot);
            }
        }

        function goToLetterSlide(index) {
            if (index < 0 || index >= totalLetterSlides) return;
            letterSlides.forEach(function(slide, i) {
                slide.classList.toggle('show', i === index);
            });
            const dots = letterDotsEl ? letterDotsEl.querySelectorAll('.letter-dot') : [];
            dots.forEach(function(dot, i) { dot.classList.toggle('active', i === index); });
            if (letterPrevBtn) letterPrevBtn.disabled = index === 0;
            if (letterNextBtn) letterNextBtn.disabled = index === totalLetterSlides - 1;
        }

        function showLoveLetter() {
            celebrationCardView.classList.add('hidden');
            celebrationLetterView.classList.add('show');
            buildLetterDots();
            goToLetterSlide(0);
        }

        if (letterPrevBtn) letterPrevBtn.addEventListener('click', function() {
            const idx = Array.from(letterSlides).findIndex(function(s) { return s.classList.contains('show'); });
            goToLetterSlide(idx - 1);
        });
        if (letterNextBtn) letterNextBtn.addEventListener('click', function() {
            const idx = Array.from(letterSlides).findIndex(function(s) { return s.classList.contains('show'); });
            goToLetterSlide(idx + 1);
        });

        /* Touch swipe for phone: slide left = next, slide right = previous */
        const letterSlidesWrap = document.querySelector('.letter-slides-wrap');
        if (letterSlidesWrap) {
            var touchStartX = 0;
            var touchEndX = 0;
            letterSlidesWrap.addEventListener('touchstart', function(e) {
                touchStartX = e.changedTouches[0].clientX;
            }, { passive: true });
            letterSlidesWrap.addEventListener('touchend', function(e) {
                touchEndX = e.changedTouches[0].clientX;
                var diff = touchStartX - touchEndX;
                if (Math.abs(diff) < 50) return;
                var idx = Array.from(letterSlides).findIndex(function(s) { return s.classList.contains('show'); });
                if (diff > 0) goToLetterSlide(idx + 1);
                else goToLetterSlide(idx - 1);
            }, { passive: true });
        }

        /* Click photo to view full size (lightbox) */
        var imageLightbox = document.getElementById('imageLightbox');
        var imageLightboxImg = document.getElementById('imageLightboxImg');
        var imageLightboxBackdrop = document.getElementById('imageLightboxBackdrop');
        var imageLightboxClose = document.getElementById('imageLightboxClose');
        if (imageLightbox && imageLightboxImg) {
            document.querySelectorAll('.celebration-pic').forEach(function(pic) {
                pic.addEventListener('click', function(e) {
                    e.preventDefault();
                    var src = this.getAttribute('src');
                    if (src) {
                        imageLightboxImg.src = src;
                        imageLightbox.classList.add('show');
                    }
                });
            });
            function closeLightbox() {
                imageLightbox.classList.remove('show');
            }
            if (imageLightboxBackdrop) imageLightboxBackdrop.addEventListener('click', closeLightbox);
            if (imageLightboxClose) imageLightboxClose.addEventListener('click', closeLightbox);
        }

        // Yes button click - show card.gif first, then love letter
        yesBtn.addEventListener('click', function() {
            document.body.classList.add('celebration-active');
            celebration.classList.add('show');
            celebrationCardView.classList.remove('hidden');
            celebrationLetterView.classList.remove('show');
            createSparkles();
            
            // Play celebration animation
            setTimeout(() => {
                yesBtn.style.transform = 'scale(1.2)';
            }, 100);

            // Show love letter after 5 seconds, or on click
            const letterTimeout = setTimeout(showLoveLetter, 5000);
            celebrationCardView.onclick = function() {
                clearTimeout(letterTimeout);
                showLoveLetter();
                celebrationCardView.onclick = null;
            };
        });

        // No button click - make Yes button bigger and change No button text
        noBtn.addEventListener('click', function() {
            noClickCount++;
            scale += 0.4; // Make Yes button bigger each time
            
            // Update the scale and grow Yes button
            yesBtn.style.setProperty('--scale', scale);
            yesBtn.classList.add('growing');
            
            // Change No button text to different reason
            const reasonIndex = Math.min(noClickCount - 1, noReasons.length - 1);
            noBtn.textContent = noReasons[reasonIndex];
            
            // Add a subtle shake animation to No button
            noBtn.style.animation = 'shake 0.5s ease';
            setTimeout(() => {
                noBtn.style.animation = '';
            }, 500);
            
            // Remove growing class after animation
            setTimeout(() => {
                yesBtn.classList.remove('growing');
                yesBtn.style.transform = `scale(${scale})`;
            }, 500);
        });

        // Create sparkles for celebration
        function createSparkles() {
            // Create initial burst of sparkles
            for (let i = 0; i < 100; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 1 + 's';
                sparkle.style.animationDuration = (1 + Math.random() * 2) + 's';
                celebration.appendChild(sparkle);
                
                setTimeout(() => {
                    sparkle.remove();
                }, 3000);
            }
            
            // Create continuous celebration sparkles
            createCelebrationSparkles();
        }

        // Create continuous sparkles around celebration content
        function createCelebrationSparkles() {
            const interval = setInterval(() => {
                if (!celebration.classList.contains('show')) {
                    clearInterval(interval);
                    return;
                }
                
                for (let i = 0; i < 5; i++) {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'celebration-sparkle';
                    
                    // Position sparkles around the celebration content area
                    const centerX = window.innerWidth / 2;
                    const centerY = window.innerHeight / 2;
                    const radius = 200 + Math.random() * 300;
                    const angle = Math.random() * Math.PI * 2;
                    
                    sparkle.style.left = (centerX + Math.cos(angle) * radius) + 'px';
                    sparkle.style.top = (centerY + Math.sin(angle) * radius) + 'px';
                    sparkle.style.animationDelay = Math.random() * 2 + 's';
                    sparkle.style.animationDuration = (1.5 + Math.random() * 1.5) + 's';
                    
                    // Random size
                    const size = 6 + Math.random() * 8;
                    sparkle.style.width = size + 'px';
                    sparkle.style.height = size + 'px';
                    
                    celebration.appendChild(sparkle);
                    
                    setTimeout(() => {
                        sparkle.remove();
                    }, 3000);
                }
            }, 300);
        }
    </script>
</body>
</html>